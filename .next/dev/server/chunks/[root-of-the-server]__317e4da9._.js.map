{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/dillonroberts/Documents/open_banking_api_003/lib/plaid.ts"],"sourcesContent":["import { Configuration, PlaidApi, PlaidEnvironments } from 'plaid';\n\nexport const plaid = new PlaidApi(new Configuration({\n  basePath: PlaidEnvironments.sandbox,\n  baseOptions: {\n    headers: {\n      'PLAID-CLIENT-ID': process.env.PLAID_CLIENT_ID!,\n      'PLAID-SECRET': process.env.PLAID_SANDBOX_SECRET!,\n    },\n  },\n}));\n\n\n\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,QAAQ,IAAI,+GAAQ,CAAC,IAAI,oHAAa,CAAC;IAClD,UAAU,wHAAiB,CAAC,OAAO;IACnC,aAAa;QACX,SAAS;YACP,mBAAmB,QAAQ,GAAG,CAAC,eAAe;YAC9C,gBAAgB,QAAQ,GAAG,CAAC,oBAAoB;QAClD;IACF;AACF","debugId":null}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///Users/dillonroberts/Documents/open_banking_api_003/lib/store.ts"],"sourcesContent":["// Simple in-memory store. Single-process only (hackathon demo).\nlet ACCESS_TOKEN: string | null = null;\nlet OVERRIDE_TXNS: any[] | null = null;\n\nexport function setAccessToken(token: string) {\n  ACCESS_TOKEN = token;\n  // Reset CSV override when linking a bank\n  OVERRIDE_TXNS = null;\n}\nexport function getAccessToken() {\n  return ACCESS_TOKEN;\n}\n\nexport function setOverrideTransactions(txns: any[]) {\n  OVERRIDE_TXNS = txns;\n}\nexport function getOverrideTransactions() {\n  return OVERRIDE_TXNS;\n}\n\n\n"],"names":[],"mappings":"AAAA,gEAAgE;;;;;;;;;;;AAChE,IAAI,eAA8B;AAClC,IAAI,gBAA8B;AAE3B,SAAS,eAAe,KAAa;IAC1C,eAAe;IACf,yCAAyC;IACzC,gBAAgB;AAClB;AACO,SAAS;IACd,OAAO;AACT;AAEO,SAAS,wBAAwB,IAAW;IACjD,gBAAgB;AAClB;AACO,SAAS;IACd,OAAO;AACT","debugId":null}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///Users/dillonroberts/Documents/open_banking_api_003/lib/kv.ts"],"sourcesContent":["import { Redis } from '@upstash/redis';\n\n// Best-effort Redis client. If env vars are missing locally, kv will be null.\nlet kvInstance: Redis | null = null;\ntry {\n  kvInstance = Redis.fromEnv();\n} catch {\n  kvInstance = null;\n}\n\nexport const kv = kvInstance;\n\n\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,8EAA8E;AAC9E,IAAI,aAA2B;AAC/B,IAAI;IACF,aAAa,6IAAK,CAAC,OAAO;AAC5B,EAAE,OAAM;IACN,aAAa;AACf;AAEO,MAAM,KAAK","debugId":null}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///Users/dillonroberts/Documents/open_banking_api_003/pages/api/exchange-public-token.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next';\nimport { plaid } from '@/lib/plaid';\nimport { setAccessToken } from '@/lib/store';\nimport { kv } from '@/lib/kv';\nimport * as cookie from 'cookie';\n\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\n  try {\n    const { public_token } = req.body as { public_token: string };\n    const resp = await plaid.itemPublicTokenExchange({ public_token });\n    const accessToken = resp.data.access_token;\n    setAccessToken(accessToken); // local dev fallback\n\n    // Persist Plaid access token for serverless environments (Vercel)\n    const cookies = cookie.parse(req.headers.cookie || '');\n    const existing = cookies['demo_session'] as string | undefined;\n    const sessionId = existing || Math.random().toString(36).slice(2) + Math.random().toString(36).slice(2);\n    if (kv) {\n      try {\n        await kv.set(`plaid_access:${sessionId}`, accessToken, { ex: 60 * 60 * 6 }); // 6h TTL\n      } catch {}\n    }\n    // Ensure client has the session cookie set\n    res.setHeader('Set-Cookie', cookie.serialize('demo_session', sessionId, {\n      path: '/',\n      httpOnly: true,\n      sameSite: 'lax',\n      maxAge: 60 * 60 * 6,\n    }));\n    res.status(200).json({ ok: true });\n  } catch (e: any) {\n    res.status(500).json({ error: e.message });\n  }\n}\n\n\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;;;;;AAEe,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC7E,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI;QACjC,MAAM,OAAO,MAAM,8GAAK,CAAC,uBAAuB,CAAC;YAAE;QAAa;QAChE,MAAM,cAAc,KAAK,IAAI,CAAC,YAAY;QAC1C,IAAA,uHAAc,EAAC,cAAc,qBAAqB;QAElD,kEAAkE;QAClE,MAAM,UAAU,8GAAY,CAAC,IAAI,OAAO,CAAC,MAAM,IAAI;QACnD,MAAM,WAAW,OAAO,CAAC,eAAe;QACxC,MAAM,YAAY,YAAY,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,KAAK,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC;QACrG,IAAI,wGAAE,EAAE;YACN,IAAI;gBACF,MAAM,wGAAE,CAAC,GAAG,CAAC,CAAC,aAAa,EAAE,WAAW,EAAE,aAAa;oBAAE,IAAI,KAAK,KAAK;gBAAE,IAAI,SAAS;YACxF,EAAE,OAAM,CAAC;QACX;QACA,2CAA2C;QAC3C,IAAI,SAAS,CAAC,cAAc,kHAAgB,CAAC,gBAAgB,WAAW;YACtE,MAAM;YACN,UAAU;YACV,UAAU;YACV,QAAQ,KAAK,KAAK;QACpB;QACA,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,IAAI;QAAK;IAClC,EAAE,OAAO,GAAQ;QACf,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO,EAAE,OAAO;QAAC;IAC1C;AACF","debugId":null}}]
}